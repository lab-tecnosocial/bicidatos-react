import L, { LatLngExpression } from "leaflet";
import React, { useEffect, useState } from "react";
import { v4 as uuidv4 } from "uuid";
import {
  MapContainer,
  Marker,
  TileLayer,
  useMap,
  Polyline,
  LayersControl,
  Polygon,
  GeoJSON,
} from "react-leaflet";
import math from "mathjs";
import mathp from "mathp";

import { makeStyles } from "@material-ui/core/styles";

import "./VerRecorridosMapa.css";
import db from "../../database/firebase";
import Cronometro from "../Cronometro/Cronometro";
import { useSelector } from "react-redux";
import { useNavigate } from "react-router-dom";
import { LatLng } from "leaflet";
import RecenterAutomatically from "../Recorrido/RecenterAutomatically";
import { setSelectedPlace } from "../../store/actions/places";
import { data } from "../../data";

let estadoSumarTotal = false;
let datos = [];
let nuevo: any;
let polilineas: any = {
  type: "FeatureCollection",
  features: [
    {
      type: "Feature",
      properties: {
        description:
          "Ciclovía construida en 1996 que recorre alrededor de la Laguna Alalay, un puente, y sobre un canal de riego bordea el Cerro de San Pedro y sigue una cuadra al norte de la Avenida América terminando en el Parque Wiracocha",
        name: "Ciclovía Norte-Este",
      },
      geometry: {
        type: "MultiLineString",
        coordinates: [],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-68.0484581, -16.5374649],
      },
      properties: {
        name: "Marker 1",
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-68.0932096, -16.5415886],
      },
      properties: {
        name: "Marker 1",
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-68.0949012, -16.5386263],
      },
      properties: {
        name: "Marker 1",
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-68.0900912, -16.5404576],
      },
      properties: {
        name: "Marker 1",
      },
    },
  ],
};
const VerRecorridosMapa = () => {
  let [polis, setPolis] = useState<any>({
    type: "FeatureCollection",
    features: [
      {
        type: "Feature",
        properties: {
          description:
            "Ciclovía construida en 1996 que recorre alrededor de la Laguna Alalay, un puente, y sobre un canal de riego bordea el Cerro de San Pedro y sigue una cuadra al norte de la Avenida América terminando en el Parque Wiracocha",
          name: "Ciclovía Norte-Este",
        },
        geometry: {
          type: "MultiLineString",
          coordinates: [],
        },
      },
    ],
  });
  let [coordenadas, setCoordenadas] = useState([]);
  let [recorridos, setRecorridos] = useState([]);
  let datosEncontradosRecorridos = [];
  let aux = [];

  const user = useSelector((state: any) => {
    return state.userReducer.user;
  });

  let [posicionActual, setPosicionActual] = useState<LatLngExpression>([
    -17.396,
    -66.153,
  ]);

  useEffect(() => {
    // const fetchData = async () => {
    //   inicializarPuntos();
    //   const p =  llamarRecorridos();
    //   console.log("Despues de esperar");
    //   console.log(p);
    // };
    inicializarPuntos();
    llamarRecorridos();
    // fetchData();
  }, []);

  async function llamarRecorridos() {
    const miColeccionPrincipal = db.collection("recorridos");
    const coleccion = await miColeccionPrincipal
      .where("UIDUsuario", "==", user.uid)
      .get();
    console.log(
      "Obteniendo historial de usuario-------------------------------------------------------------------------------------------------------------"
    );
    console.log(coleccion.docs[0].id);
    let historial: any = await db
      .collection("recorridos")
      .doc(coleccion.docs[0].id)
      .collection("historial")
      .get();
    console.log(historial.docs[0].data());
    // polilineas.features[0].geometry.coordinates = [];
    let aux=[];
    for (let i = 0; i < historial.docs.length; i++) {
      console.log(
        "RECORRIDO " +
          i +
          "-----------------------------------------------------------------------------------------------------------------------------------------"
      );
      // console.log(JSON.parse(historial.docs[i].data().puntosRecorridos).data);
      aux.push(JSON.parse(historial.docs[i].data().puntosRecorridos).data);
      // console.log(polilineas);

    }
    console.log(aux)
    polilineas.features[0].geometry.coordinates=aux;
    console.log(polilineas);
    console.log(geoJsonData)

    const miSubColeccion = await miColeccionPrincipal
      .where("UIDUsuario", "==", user.uid)
      .get()
      .then((querySnapshot) => {
        querySnapshot.forEach((doc) => {
          const historial = db
            .collection("recorridos")
            .doc(doc.id)
            .collection("historial");
          historial.get().then((querySnapshot) => {
            querySnapshot.forEach((doc2) => {
              datosEncontradosRecorridos.push({
                ...doc2.data(),
                color: getRandomHexColor(),
              });
            });
            // console.log(
            //   JSON.parse(datosEncontradosRecorridos[0].puntosRecorridos).data
            // );
            // polilineas.features[0].geometry.coordinates = [];
            // polilineas.features[0].geometry.coordinates.push(
            //   JSON.parse(datosEncontradosRecorridos[0].puntosRecorridos).data
            // );
            // setPolis(polilineas);
            setRecorridos(datosEncontradosRecorridos);
            // console.log("Recorridos obtenidos");
            // console.log(recorridos);
            // console.log(polis);
          });
        });
      });
  }
  useEffect(() => {
    setPolis(polis);
  }, [polis]);
  function agregarPuntos(aux) {
    let aux2 = [];
    for (let i = 1; i <= aux.length; i++) {
      if (i % 11 == 0) {
        polilineas.features[0].geometry.coordinates.push(aux2);
        polis.features[0].geometry.coordinates.push(aux2);
        aux2 = [];
      }
      aux2.push(aux[i]);
    }
  }
  function inicializarPuntos() {
    navigator.geolocation.getCurrentPosition(
      (position) => {
        setPosicionActual([
          position.coords.latitude,
          position.coords.longitude,
        ]);
      },
      (error) => {},
      { enableHighAccuracy: true }
    );
  }
  function getRandomHexColor() {
    const letters = "0123456789ABCDEF";
    let color = "#";
    for (let i = 0; i < 6; i++) {
      color += letters[Math.floor(Math.random() * 16)];
    }
    return color;
  }
  const puntosPrueba = [
    new L.LatLng(51.505, -0.09),
    new L.LatLng(51.507, -0.06),
    new L.LatLng(51.51, -0.047),
  ];
  const convertirFormatoFecha = (data: any) => {
    const date = data.fecha.toDate();
    const day = date.getDate().toString().padStart(2, "0");
    const month = (date.getMonth() + 1).toString().padStart(2, "0");
    const year = date.getFullYear();
    return `${year}-${month}-${day}`;
  };
  const geoJsonData: any = {
    type: "FeatureCollection",
    features: [
      // {
      //   type: 'Feature',
      //   geometry: {
      //     type: 'Point',
      //     coordinates: [10.0, 10.0]
      //   },
      //   properties: {
      //     name: 'Marker 1'
      //   }
      // },
      // {
      //   type: 'Feature',
      //   geometry: {
      //     type: 'Point',
      //     coordinates: [20.0, 20.0]
      //   },
      //   properties: {
      //     name: 'Marker 2'
      //   }
      // }
      // [-68.0483789, -16.5363521],
      // [-68.0964074, -16.5347854],
      // [-68.1111697, -16.5239507],
      // [-68.0830088, -16.5390288],
      // [-68.0484581, -16.5374649],
      // [-68.0932096, -16.5415886],
      //[-68.0900912, -16.5404576],
      //[-68.0949012, -16.5386263],
      // {
      //   type: 'Feature',
      //   geometry: {
      //     type: 'Point',
      //     coordinates: [-68.0964074, -16.5347854]
      //   },
      //   properties: {
      //     name: 'Marker 1'
      //   }
      // },
      // {
      //   type: 'Feature',
      //   geometry: {
      //     type: 'Point',
      //     coordinates: [-68.1111697, -16.5239507]
      //   },
      //   properties: {
      //     name: 'Marker 1'
      //   }
      // },
      // {
      //   type: 'Feature',
      //   geometry: {
      //     type: 'Point',
      //     coordinates: [-68.0949012, -16.5386263]
      //   },
      //   properties: {
      //     name: 'Marker 1'
      //   }
      // },
      {
        type: "Feature",
        geometry: {
          type: "Point",
          coordinates: [-68.0484581, -16.5374649],
        },
        properties: {
          name: "Marker 1",
        },
      },
      {
        type: "Feature",
        geometry: {
          type: "Point",
          coordinates: [-68.0932096, -16.5415886],
        },
        properties: {
          name: "Marker 1",
        },
      },
      {
        type: "Feature",
        geometry: {
          type: "Point",
          coordinates: [-68.0949012, -16.5386263],
        },
        properties: {
          name: "Marker 1",
        },
      },
      {
        type: "Feature",
        geometry: {
          type: "Point",
          coordinates: [-68.0900912, -16.5404576],
        },
        properties: {
          name: "Marker 1",
        },
      },
      {
        type: "Feature",
        
        properties: {
          description:
            "Ciclovía construida en 1996 que recorre alrededor de la Laguna Alalay, un puente, y sobre un canal de riego bordea el Cerro de San Pedro y sigue una cuadra al norte de la Avenida América terminando en el Parque Wiracocha",
          name: "Ciclovía Norte-Este",
          
        },
        geometry: {
          type: "MultiLineString",
          coordinates: [
            [
              // [-68.0814206, -16.5386619],
              // [-68.1113668, -16.5238629],
              // [-68.105378, -16.5270068],
              // [-68.0744632, -16.5402342],
              // [-68.0553434, -16.5402069],
              // [-68.0774969, -16.5390573],
              // [-68.0997664, -16.5307043],
              // [-68.058276, -16.5416654],
              // [-68.0755254, -16.5390939],
              // [-68.1023997, -16.5285231],
              // [-68.0952723, -16.5374325],
              // [-68.0754734, -16.5392744],
              // [-68.1033009, -16.5283813],
              // [-68.0896495, -16.5404301],
              // [-68.0703329, -16.5402812],
              // [-68.0955585, -16.5366346],
              // [-68.0567113, -16.5396008],
              // [-68.0810298, -16.5387513],
              // [-68.0889009, -16.5401855],
              // [-68.0709008, -16.5398222],
              // [-68.0906323, -16.5412967],
              // [-68.0861366, -16.5397027],
              // [-68.0957771, -16.5360503],
              // [-68.0963753, -16.5348571],
              // [-68.0518869, -16.5380689],
              // [-68.0575216, -16.5406776],
              // [-68.0824306, -16.538681],
              // [-68.1093543, -16.5246993],
              // [-68.0825576, -16.5386965],
              // [-68.1045798, -16.5273619],
              // [-68.0684176, -16.5405299],
              // [-68.0860369, -16.5397577],
              // [-68.0882604, -16.5400654],
              // [-68.0957771, -16.5360503],
              // [-68.0652904, -16.5403879],
              // [-68.1026388, -16.528482],
              // [-68.10107, -16.5294831],
              // [-68.0762826, -16.5391133],
              // [-68.0815543, -16.5387318],
              // [-68.10107, -16.5294831],
              // [-68.1018044, -16.5288111],
              // [-68.0989272, -16.5316765],
              // [-68.0855155, -16.5400082],
              // [-68.1116402, -16.5234751],
              // [-68.063793, -16.5406848],
              // [-68.1043021, -16.5274873],
              // [-68.0550592, -16.5402856],
              // [-68.0545692, -16.5400165],
              // [-68.0513643, -16.5377931],
              // [-68.0510145, -16.5377955],
              // [-68.0595643, -16.5409105],
              // [-68.0984562, -16.5322759],
              // [-68.0670383, -16.5407262],
              // [-68.0765245, -16.5390418],
              // [-68.0861539, -16.5395264],
              // [-68.1059464, -16.5265102],
              // [-68.0943221, -16.5406533],
              // [-68.0571875, -16.5401504],
              // [-68.0559078, -16.5395076],
              // [-68.1117318, -16.5234217],
              // [-68.0563246, -16.5395666],
              // [-68.0743292, -16.5402584],
              // [-68.0827251, -16.5390826],
              // [-68.0612482, -16.5413813],
              // [-68.0852036, -16.5394264],
              // [-68.0791222, -16.5391048],
              // [-68.0911487, -16.5411135],
              // [-68.0994684, -16.5310203],
              // [-68.1058262, -16.5264852],
              // [-68.0570838, -16.539989],
              // [-68.0535471, -16.5392041],
              // [-68.0890671, -16.5400868],
              // [-68.07844, -16.5389533],
              // [-68.0568795, -16.5396058],
              // [-68.0550592, -16.5402856],
              // [-68.0601159, -16.5411541],
              // [-68.0792696, -16.539155],
              // [-68.0825823, -16.5389597],
              // [-68.0629175, -16.5409642],
              // [-68.0824424, -16.5388807],
              // [-68.0799635, -16.5390256],
              // [-68.0949809, -16.5383324],
              // [-68.0483789, -16.5363521],
              // [-68.0964074, -16.5347854],
              // [-68.1111697, -16.5239507],
              // [-68.0830088, -16.5390288],
              // [-68.0484581, -16.5374649],
              // [-68.0932096, -16.5415886],
              // [-68.0900912, -16.5404576],
              // [-68.0932096, -16.5415886],
              // [-68.0949012, -16.5386263],
              [-68.1124353, -16.5207766],
              [-68.1113482, -16.5221915],
              [-68.1109917, -16.5226492],
              [-68.1113482, -16.5221915],
              [-68.1113482, -16.5221915],
              [-68.1122639, -16.5208767],
              [-68.1124353, -16.5207766],
              [-68.1122639, -16.5208767],
              [-68.1122639, -16.5208767],
              [-68.1113482, -16.5221915],
              [-68.1109917, -16.5226492],
              [-68.1113482, -16.5221915],
              [-68.1122639, -16.5208767],
              [-68.1109917, -16.5226492],
              [-68.1122639, -16.5208767],
              [-68.1124353, -16.5207766],
              [-68.1124353, -16.5207766],
              [-68.1124353, -16.5207766],
            ],
            [
              [-66.1585212, -17.3690045],
              [-66.1584396, -17.3690312],
              [-66.1583326, -17.3690655],
              [-66.1582773, -17.3690857],
              [-66.1580095, -17.3692579],
              [-66.15724, -17.3697467],
              [-66.1571364, -17.3697975],
              [-66.1570228, -17.3698398],
              [-66.1569268, -17.3698689],
              [-66.1568267, -17.3698815],
              [-66.1567875, -17.3698843],
              [-66.1566891, -17.3698924],
              [-66.156585, -17.3698984],
              [-66.156054, -17.3699421],
              [-66.1562071, -17.3698746],
              [-66.1563403, -17.3698381],
              [-66.1564266, -17.3698299],
              [-66.1565619, -17.369819],
              [-66.1568251, -17.3697962],
              [-66.1570438, -17.3697822],
              [-66.1571242, -17.3697722],
              [-66.15724, -17.3697467],
            ],
            [
              [-66.1346363, -17.3995658],
              [-66.1347612, -17.3995371],
            ],
            [
              [-66.1341997, -17.4001339],
              [-66.1342182, -17.3999773],
              [-66.1342955, -17.3998676],
              [-66.1343991, -17.3997663],
              [-66.1345413, -17.3996696],
              [-66.1346363, -17.3995658],
              [-66.1347244, -17.3994865],
              [-66.1347382, -17.3994703],
              [-66.1348626, -17.3993931],
              [-66.1349882, -17.3993529],
              [-66.1350732, -17.3993322],
              [-66.1351965, -17.3993292],
              [-66.1354251, -17.399315],
              [-66.1356338, -17.3993075],
              [-66.1359503, -17.3993737],
              [-66.1361436, -17.3993499],
              [-66.1365713, -17.3994017],
              [-66.1373804, -17.3995115],
              [-66.1374047, -17.3995149],
              [-66.137623, -17.3995567],
              [-66.1379232, -17.399629],
              [-66.1384343, -17.3998037],
              [-66.1395198, -17.400183],
              [-66.1396295, -17.4002151],
              [-66.1399884, -17.4002961],
              [-66.1400365, -17.4003069],
              [-66.1401815, -17.4003322],
              [-66.1405448, -17.4004057],
              [-66.1421299, -17.4006897],
              [-66.1428511, -17.4008223],
              [-66.1434316, -17.4009151],
              [-66.1435636, -17.4009424],
              [-66.1438559, -17.4010029],
              [-66.1446638, -17.4011452],
              [-66.1452655, -17.4012568],
              [-66.1456699, -17.4013523],
              [-66.1458728, -17.4014069],
              [-66.1462265, -17.4014968],
              [-66.1463492, -17.4015276],
              [-66.1464498, -17.4015627],
              [-66.1465281, -17.4016119],
              [-66.146592, -17.4016951],
              [-66.146705, -17.4018671],
              [-66.1467801, -17.4020413],
              [-66.1468348, -17.4021769],
              [-66.1468566, -17.4022567],
              [-66.1468702, -17.4023409],
              [-66.1468805, -17.4025317],
              [-66.1468765, -17.402612],
              [-66.1468644, -17.4026681],
              [-66.1468537, -17.4027175],
              [-66.146824, -17.4028034],
              [-66.1466281, -17.4031653],
              [-66.146566, -17.4032579],
              [-66.1464438, -17.4034439],
              [-66.1463418, -17.4036042],
              [-66.1462089, -17.4037035],
              [-66.1460589, -17.4038329],
              [-66.145919, -17.4039549],
              [-66.1458352, -17.4040431],
              [-66.1457948, -17.4041133],
              [-66.1455302, -17.4046145],
              [-66.1453779, -17.4049291],
              [-66.1451282, -17.4053518],
              [-66.1448707, -17.4058105],
              [-66.1448431, -17.405873],
              [-66.1448082, -17.4059637],
              [-66.1447902, -17.4060628],
              [-66.1447938, -17.4061186],
              [-66.1447735, -17.4061832],
              [-66.1447221, -17.4062427],
              [-66.1446536, -17.4062857],
              [-66.1445699, -17.4063474],
              [-66.1444916, -17.4064329],
              [-66.1442871, -17.4067002],
              [-66.1441233, -17.4069246],
              [-66.1439575, -17.4071536],
              [-66.1438863, -17.4073281],
              [-66.1438325, -17.4073949],
              [-66.1437823, -17.4074411],
              [-66.1436779, -17.4075405],
              [-66.1435432, -17.4076718],
              [-66.1433026, -17.4080079],
              [-66.143138, -17.4082624],
              [-66.1427532, -17.4089186],
              [-66.1426361, -17.4091806],
              [-66.1425422, -17.4094687],
              [-66.1424027, -17.4102626],
              [-66.1423687, -17.4104032],
              [-66.1423221, -17.410636],
              [-66.1422988, -17.4111883],
              [-66.1422639, -17.4122046],
              [-66.142202, -17.4129406],
              [-66.1421356, -17.413943],
              [-66.1420515, -17.4142349],
              [-66.1419133, -17.4145869],
              [-66.1417436, -17.4149057],
              [-66.1415839, -17.4151228],
              [-66.1412964, -17.4154737],
              [-66.14087, -17.4157743],
              [-66.140652, -17.4158757],
              [-66.1404765, -17.4159962],
              [-66.1403808, -17.4160469],
              [-66.1400378, -17.4162058],
              [-66.1395965, -17.4163917],
              [-66.1378588, -17.4170945],
              [-66.1376508, -17.4171983],
              [-66.1370918, -17.4175092],
              [-66.1367663, -17.4177267],
              [-66.1362537, -17.4180821],
              [-66.1356726, -17.4185297],
              [-66.1355802, -17.4186071],
              [-66.1353995, -17.4187418],
              [-66.1353051, -17.418789],
              [-66.1350726, -17.4188558],
              [-66.1345326, -17.4189824],
              [-66.134208, -17.4190538],
              [-66.1341193, -17.4190526],
              [-66.1339835, -17.4190123],
              [-66.1336717, -17.4188972],
              [-66.1334412, -17.4188131],
              [-66.133362, -17.418776],
              [-66.1332373, -17.4186982],
              [-66.1329347, -17.4184799],
              [-66.1326461, -17.4182868],
              [-66.1323367, -17.4180872],
              [-66.1322196, -17.4180252],
              [-66.1321199, -17.4179874],
              [-66.1320417, -17.4179597],
              [-66.1316524, -17.417834],
              [-66.1313405, -17.4177635],
              [-66.1312009, -17.4177362],
              [-66.1305121, -17.4176013],
              [-66.1301386, -17.4175342],
              [-66.1300565, -17.417522],
              [-66.1299403, -17.4175047],
              [-66.1297342, -17.4174768],
              [-66.1292491, -17.4173836],
              [-66.1292299, -17.4173799],
              [-66.1287207, -17.4172775],
              [-66.1280443, -17.4171491],
              [-66.1280226, -17.4171432],
              [-66.127807, -17.4170848],
              [-66.1276835, -17.4170514],
              [-66.1273984, -17.4169796],
              [-66.1271658, -17.4168967],
              [-66.1270275, -17.4168103],
              [-66.1269231, -17.4167346],
              [-66.1267055, -17.416547],
              [-66.1266447, -17.4164765],
              [-66.1265463, -17.4163624],
              [-66.126511, -17.4163214],
              [-66.1263622, -17.4160482],
              [-66.1263085, -17.4159158],
              [-66.1262541, -17.4157302],
              [-66.1262115, -17.4154769],
              [-66.1261999, -17.4152881],
              [-66.1262109, -17.4151454],
              [-66.1262448, -17.414861],
              [-66.1262823, -17.414544],
              [-66.126343, -17.4140492],
              [-66.1264171, -17.4134761],
              [-66.1264781, -17.4129822],
              [-66.1265175, -17.4126866],
              [-66.1265261, -17.4126459],
              [-66.1265506, -17.412554],
              [-66.1266485, -17.4122869],
              [-66.1266959, -17.4120338],
              [-66.1267257, -17.4118085],
              [-66.1267674, -17.4115144],
              [-66.126773, -17.4114746],
              [-66.1268356, -17.4110664],
              [-66.1268899, -17.4107145],
              [-66.1269719, -17.4102617],
              [-66.127022, -17.4100691],
              [-66.1270741, -17.4097943],
              [-66.1271343, -17.4095527],
              [-66.1272156, -17.4090697],
              [-66.127317, -17.4086311],
              [-66.127407, -17.4083029],
              [-66.1274474, -17.4081851],
              [-66.1275315, -17.407994],
              [-66.1277053, -17.407621],
              [-66.1277882, -17.4074564],
              [-66.1278803, -17.4072906],
              [-66.1279689, -17.4071352],
              [-66.1281552, -17.4068196],
              [-66.1283581, -17.4064218],
              [-66.1283957, -17.4063582],
              [-66.1284221, -17.4063151],
              [-66.1285153, -17.4062025],
              [-66.1288609, -17.4057021],
              [-66.1293083, -17.4051078],
              [-66.1295472, -17.4048819],
              [-66.1297938, -17.4046268],
              [-66.1302867, -17.4042263],
              [-66.1303664, -17.4041636],
              [-66.1307527, -17.4038543],
              [-66.1309055, -17.4037368],
              [-66.1312114, -17.4035099],
              [-66.1315289, -17.4032543],
              [-66.1318761, -17.4030052],
              [-66.1321878, -17.40277],
              [-66.1324496, -17.4025697],
              [-66.1325601, -17.4025026],
              [-66.1326247, -17.4024948],
              [-66.132769, -17.4025198],
              [-66.1328787, -17.4025223],
              [-66.1329517, -17.4024948],
              [-66.1330132, -17.4024484],
              [-66.1330685, -17.4023368],
              [-66.1330837, -17.4022335],
              [-66.1331223, -17.4020156],
              [-66.133173, -17.4017983],
              [-66.1334435, -17.4013411],
              [-66.1335975, -17.4010534],
              [-66.1338077, -17.4007183],
              [-66.1339298, -17.4005465],
              [-66.1340905, -17.4003788],
              [-66.1341606, -17.4002809],
              [-66.1341838, -17.4002156],
              [-66.1341997, -17.4001339],
            ],
            // [
            //   [-66.1347244, -17.3994865],
            //   [-66.1347233, -17.3995141],
            //   [-66.1347351, -17.399531],
            //   [-66.1347612, -17.3995371],
            //   [-66.1347877, -17.3995291],
            //   [-66.1348177, -17.3994968],
            //   [-66.1348693, -17.3994458],
            //   [-66.1349188, -17.3994218],
            //   [-66.1349791, -17.3994045],
            //   [-66.1350137, -17.3994011],
            //   [-66.1350378, -17.3994137],
            //   [-66.1350471, -17.3994368],
            //   [-66.1350448, -17.3994609],
            //   [-66.1350292, -17.3994817],
            //   [-66.1349325, -17.3995507],
            //   [-66.1348067, -17.3996208],
            //   [-66.1344058, -17.3998507],
            //   [-66.1341903, -17.4000931],
            //   [-66.1340482, -17.4002998],
            //   [-66.1340155, -17.4003482],
            //   [-66.1339606, -17.4003821],
            //   [-66.1339411, -17.4003816],
            //   [-66.1337497, -17.4002906],
            //   [-66.1337312, -17.4002795],
            //   [-66.133715, -17.4002619],
            //   [-66.1337047, -17.4002357],
            //   [-66.1337099, -17.4002104],
            //   [-66.1337539, -17.4001507],
            //   [-66.1338029, -17.4000741],
            //   [-66.1339387, -17.3997882],
            //   [-66.1341032, -17.3995904],
            //   [-66.13432, -17.3993133],
            //   [-66.1345443, -17.399061],
            //   [-66.1347268, -17.3988408],
            //   [-66.1347797, -17.3987931],
            //   [-66.1347852, -17.3987603],
            //   [-66.1347594, -17.3987328],
            //   [-66.1347289, -17.3987255],
            //   [-66.1346877, -17.3987439],
            //   [-66.1346366, -17.3988115],
            //   [-66.1345449, -17.3989262],
            //   [-66.1344348, -17.3990476],
            //   [-66.1341971, -17.399245],
            //   [-66.133927, -17.3995301],
            //   [-66.1337857, -17.3996808],
            //   [-66.1335876, -17.3998943],
            //   [-66.1335069, -17.4000086],
            //   [-66.1334369, -17.4001964],
            //   [-66.1333157, -17.4004439],
            //   [-66.1332949, -17.4005298],
            //   [-66.1332709, -17.4005918],
            //   [-66.1331993, -17.4007039],
            //   [-66.1331097, -17.40079],
            //   [-66.1330369, -17.4008431],
            //   [-66.1329715, -17.4008649],
            //   [-66.1329177, -17.4008547],
            //   [-66.1328854, -17.4008365],
            //   [-66.132869, -17.4008052],
            //   [-66.1328696, -17.4007577],
            //   [-66.1328908, -17.4007149],
            //   [-66.132946, -17.4006832],
            //   [-66.1330164, -17.400647],
            //   [-66.1330918, -17.400596],
            //   [-66.1331415, -17.4005261],
            //   [-66.1331922, -17.4004072],
            //   [-66.1332871, -17.4002098],
            //   [-66.13339, -17.3999878],
            //   [-66.133509, -17.3997748],
            //   [-66.1335906, -17.3996465],
            //   [-66.1337001, -17.3995273],
            //   [-66.1338323, -17.3993765],
            //   [-66.133989, -17.3991861],
            //   [-66.1343729, -17.3987783],
            //   [-66.1346787, -17.3984346],
            //   [-66.1348487, -17.3982379],
            //   [-66.1348771, -17.398168],
            //   [-66.1348785, -17.3980917],
            //   [-66.1348556, -17.3980002],
            //   [-66.1347662, -17.3976989],
            //   [-66.1347329, -17.3975551],
            //   [-66.1347236, -17.3974686],
            //   [-66.1347346, -17.3973714],
            //   [-66.1347687, -17.3972748],
            //   [-66.1348318, -17.397183],
            //   [-66.1349219, -17.3970717],
            //   [-66.1350989, -17.3968599],
            //   [-66.1351635, -17.3967372],
            //   [-66.1352408, -17.3966509],
            //   [-66.1352932, -17.3965941],
            //   [-66.1353321, -17.396511],
            //   [-66.1353575, -17.3963954],
            //   [-66.1353597, -17.396219],
            //   [-66.1353751, -17.3960914],
            //   [-66.1354298, -17.3958411],
            //   [-66.1354424, -17.3957834],
            //   [-66.1355312, -17.395559],
            //   [-66.1357257, -17.3951842],
            //   [-66.1357523, -17.3950942],
            //   [-66.135933, -17.3945121],
            //   [-66.1359621, -17.394399],
            //   [-66.1359776, -17.3941203],
            //   [-66.1360126, -17.3938661],
            //   [-66.1360396, -17.393624],
            //   [-66.1360381, -17.3934899],
            //   [-66.1359295, -17.392883],
            //   [-66.1358971, -17.3927751],
            //   [-66.1358545, -17.392724],
            //   [-66.1357758, -17.3926423],
            //   [-66.1355291, -17.3924357],
            //   [-66.1354109, -17.3923344],
            //   [-66.1353516, -17.3922117],
            //   [-66.1353136, -17.3920518],
            //   [-66.1352834, -17.3919197],
            //   [-66.1352547, -17.3917973],
            //   [-66.135251, -17.3917052],
            //   [-66.1353337, -17.3914584],
            //   [-66.1354067, -17.3912523],
            //   [-66.1354243, -17.3911438],
            //   [-66.1354257, -17.3910213],
            //   [-66.1353752, -17.3906267],
            //   [-66.1353081, -17.3904527],
            //   [-66.1352785, -17.3903478],
            //   [-66.135293, -17.3902906],
            //   [-66.1353623, -17.3902219],
            //   [-66.1354316, -17.3901731],
            //   [-66.1354659, -17.3901477],
            //   [-66.135519, -17.3901261],
            //   [-66.1355721, -17.3901044],
            //   [-66.1356845, -17.3900772],
            //   [-66.1357713, -17.3900804],
            //   [-66.1359735, -17.3900864],
            //   [-66.136212, -17.3900893],
            //   [-66.1363475, -17.3900919],
            //   [-66.1364433, -17.3901083],
            //   [-66.1366308, -17.3902111],
            //   [-66.1369689, -17.3903724],
            //   [-66.1371059, -17.3904339],
            //   [-66.1373858, -17.3905293],
            //   [-66.1374589, -17.390543],
            //   [-66.1375402, -17.3905217],
            //   [-66.1376043, -17.3904727],
            //   [-66.1377016, -17.3904009],
            //   [-66.1377614, -17.3903246],
            //   [-66.1377877, -17.3902957],
            //   [-66.1378409, -17.3902374],
            //   [-66.1378759, -17.3902107],
            //   [-66.1380787, -17.3900764],
            //   [-66.138283, -17.3899752],
            //   [-66.1384684, -17.3898801],
            //   [-66.1385591, -17.3898584],
            //   [-66.1386272, -17.3898537],
            //   [-66.1391872, -17.3899014],
            //   [-66.1392499, -17.3898967],
            //   [-66.1392787, -17.3898958],
            //   [-66.1392878, -17.3898955],
            //   [-66.1393911, -17.3898461],
            //   [-66.1394971, -17.3897588],
            //   [-66.1396535, -17.3895886],
            //   [-66.1396673, -17.3895735],
            //   [-66.1397517, -17.3894702],
            //   [-66.1398872, -17.3892472],
            //   [-66.1400561, -17.3889566],
            //   [-66.1401748, -17.3887118],
            //   [-66.1402134, -17.3886101],
            //   [-66.1402341, -17.3884989],
            //   [-66.1402557, -17.3884374],
            //   [-66.1403002, -17.3883448],
            //   [-66.1403233, -17.3882748],
            //   [-66.1403379, -17.3881855],
            //   [-66.1403495, -17.3880427],
            //   [-66.1403545, -17.3879493],
            //   [-66.1403512, -17.3877498],
            //   [-66.1403605, -17.3876756],
            //   [-66.1403745, -17.387624],
            //   [-66.1404911, -17.3872856],
            //   [-66.1405437, -17.3871168],
            //   [-66.1405687, -17.3869896],
            //   [-66.1405995, -17.3868472],
            //   [-66.1406126, -17.3866981],
            //   [-66.1406155, -17.3865613],
            //   [-66.1406301, -17.386314],
            //   [-66.1406254, -17.3861452],
            //   [-66.1405952, -17.3857947],
            //   [-66.140603, -17.3856359],
            //   [-66.1406361, -17.3851695],
            //   [-66.1406666, -17.3850231],
            //   [-66.1407306, -17.3848398],
            //   [-66.1407445, -17.3847477],
            //   [-66.1407853, -17.3845318],
            //   [-66.140816, -17.3844751],
            //   [-66.1408507, -17.3844433],
            //   [-66.1409648, -17.3843758],
            //   [-66.1413803, -17.3841651],
            //   [-66.1414474, -17.3841215],
            //   [-66.1414828, -17.3840835],
            //   [-66.1415412, -17.3840399],
            //   [-66.1416327, -17.3839827],
            //   [-66.1416586, -17.3839596],
            //   [-66.1416749, -17.3839339],
            //   [-66.1416965, -17.3838801],
            //   [-66.1417141, -17.3838346],
            //   [-66.1417502, -17.3837409],
            //   [-66.1418047, -17.3835995],
            //   [-66.1418679, -17.3834554],
            //   [-66.1419438, -17.3832873],
            //   [-66.1421207, -17.3828954],
            //   [-66.1421369, -17.3828467],
            //   [-66.1421511, -17.3827953],
            //   [-66.1421594, -17.3827457],
            //   [-66.1421721, -17.3826175],
            //   [-66.1421799, -17.3825393],
            //   [-66.1421852, -17.3824176],
            //   [-66.1421757, -17.3823826],
            //   [-66.1421602, -17.3823533],
            //   [-66.1421125, -17.3822997],
            //   [-66.1419709, -17.3821857],
            //   [-66.1418029, -17.3820552],
            //   [-66.1415788, -17.3819172],
            //   [-66.1415388, -17.3818864],
            //   [-66.141421, -17.3817807],
            //   [-66.1412649, -17.3816365],
            //   [-66.1411974, -17.3815598],
            //   [-66.141108, -17.3813921],
            //   [-66.1410648, -17.3813152],
            //   [-66.1410132, -17.3812477],
            //   [-66.1409559, -17.3811816],
            //   [-66.1408138, -17.3810127],
            //   [-66.1407853, -17.3809788],
            //   [-66.1407513, -17.3809539],
            //   [-66.1407113, -17.3809282],
            //   [-66.1405087, -17.3808607],
            //   [-66.1403541, -17.3808093],
            //   [-66.1402685, -17.3807856],
            //   [-66.1394208, -17.3806126],
            //   [-66.1393133, -17.3805936],
            //   [-66.1392461, -17.3805678],
            //   [-66.1392084, -17.380545],
            //   [-66.1391679, -17.3805113],
            //   [-66.1391196, -17.3804561],
            //   [-66.1390977, -17.3804144],
            //   [-66.1390116, -17.3801675],
            //   [-66.1389601, -17.3800713],
            //   [-66.1389145, -17.379997],
            //   [-66.138708, -17.37977],
            //   [-66.138639, -17.3796827],
            //   [-66.1386046, -17.3796297],
            //   [-66.138575, -17.3795541],
            //   [-66.1385687, -17.3794986],
            //   [-66.1385711, -17.3794486],
            //   [-66.1385867, -17.3791982],
            //   [-66.1385837, -17.3791117],
            //   [-66.1385662, -17.3790347],
            //   [-66.1385295, -17.3789522],
            //   [-66.13832, -17.3786161],
            //   [-66.1383097, -17.3785858],
            //   [-66.1383052, -17.3785554],
            //   [-66.1383402, -17.3784688],
            //   [-66.138316, -17.3785057],
            //   [-66.1385018, -17.378319],
            //   [-66.1385256, -17.3782836],
            //   [-66.1385379, -17.3782523],
            //   [-66.1385798, -17.3780783],
            //   [-66.1385767, -17.378043],
            //   [-66.1385599, -17.3780101],
            //   [-66.1385372, -17.3779879],
            //   [-66.1385073, -17.3779711],
            //   [-66.1383257, -17.3779121],
            //   [-66.138278, -17.3778899],
            //   [-66.1382419, -17.3778636],
            //   [-66.1381832, -17.3777745],
            //   [-66.1380659, -17.3775592],
            //   [-66.1380592, -17.377515],
            //   [-66.1380583, -17.3774789],
            //   [-66.1380655, -17.3774259],
            //   [-66.1380722, -17.3773902],
            //   [-66.1381723, -17.3764093],
            //   [-66.1382817, -17.3753464],
            //   [-66.1382964, -17.375164],
            //   [-66.1383105, -17.3751157],
            //   [-66.1383434, -17.3750785],
            //   [-66.1383822, -17.3750583],
            //   [-66.1391709, -17.3747428],
            //   [-66.1392346, -17.374714],
            //   [-66.1392946, -17.3746805],
            //   [-66.1393374, -17.3746511],
            //   [-66.1394743, -17.37451],
            //   [-66.1396418, -17.3743412],
            //   [-66.1397057, -17.374287],
            //   [-66.1398001, -17.3742488],
            //   [-66.139947, -17.3742343],
            //   [-66.1400277, -17.3742417],
            //   [-66.1405937, -17.3743053],
            //   [-66.140787, -17.3743226],
            //   [-66.140992, -17.3743369],
            //   [-66.1414637, -17.3743935],
            //   [-66.1415888, -17.3744056],
            //   [-66.1416879, -17.3744115],
            //   [-66.1417808, -17.3744],
            //   [-66.1418662, -17.3743745],
            //   [-66.1419405, -17.374354],
            //   [-66.1420369, -17.3743193],
            //   [-66.1425434, -17.3740229],
            //   [-66.1427548, -17.3738999],
            //   [-66.1430265, -17.373777],
            //   [-66.1431773, -17.3737242],
            //   [-66.1434355, -17.3736258],
            //   [-66.143554, -17.3736005],
            //   [-66.1436904, -17.3735868],
            //   [-66.1437799, -17.3735837],
            //   [-66.1438156, -17.3735775],
            //   [-66.143845, -17.3735665],
            //   [-66.1439662, -17.373525],
            //   [-66.1440138, -17.3735194],
            //   [-66.1442908, -17.3735006],
            //   [-66.1444597, -17.3734912],
            //   [-66.144497, -17.3734893],
            //   [-66.1445713, -17.3734855],
            //   [-66.1450544, -17.3734451],
            //   [-66.1452917, -17.3734153],
            //   [-66.1457605, -17.3733245],
            //   [-66.1458134, -17.3733122],
            //   [-66.145862, -17.3733009],
            //   [-66.1461348, -17.3732447],
            //   [-66.1461754, -17.3732338],
            //   [-66.1462954, -17.3732016],
            //   [-66.146364, -17.3731677],
            //   [-66.1464363, -17.3731127],
            //   [-66.1465336, -17.3730274],
            //   [-66.1465901, -17.3729877],
            //   [-66.1467199, -17.3729159],
            //   [-66.1468165, -17.3728782],
            //   [-66.1469207, -17.3728453],
            //   [-66.1473743, -17.3727342],
            //   [-66.1474684, -17.3727116],
            //   [-66.147571, -17.3727021],
            //   [-66.147686, -17.3727073],
            //   [-66.1477712, -17.3726966],
            //   [-66.1478788, -17.3726627],
            //   [-66.14806, -17.3725945],
            //   [-66.1482298, -17.3725339],
            //   [-66.1483632, -17.3724909],
            //   [-66.1484693, -17.3724689],
            //   [-66.1485547, -17.3724633],
            //   [-66.1486407, -17.372467],
            //   [-66.148763, -17.3724844],
            //   [-66.1489242, -17.3725109],
            //   [-66.1490863, -17.3725337],
            //   [-66.1491782, -17.3725434],
            //   [-66.1492717, -17.3725405],
            //   [-66.1494, -17.3725266],
            //   [-66.1494532, -17.3725246],
            //   [-66.1495015, -17.3725207],
            //   [-66.1495397, -17.3725202],
            //   [-66.1495662, -17.3725206],
            //   [-66.1496013, -17.3725211],
            //   [-66.1496416, -17.3725018],
            //   [-66.1497054, -17.3724634],
            //   [-66.149734, -17.3724316],
            //   [-66.1497601, -17.3724161],
            //   [-66.1498047, -17.3723983],
            //   [-66.1499347, -17.3723514],
            //   [-66.1500861, -17.3722986],
            //   [-66.1502455, -17.3722325],
            //   [-66.1505557, -17.3720732],
            //   [-66.1512713, -17.3716896],
            //   [-66.1513344, -17.3716577],
            //   [-66.1514023, -17.3716217],
            //   [-66.1522803, -17.371157],
            //   [-66.1524173, -17.3710641],
            //   [-66.1525605, -17.3709469],
            // ],
          ],
        },
        id: "relation/12048978",
      },
    ],
  };
  return (
    <div id="principal">
      <div>
        <table>
          <thead>
            <tr>
              <th>Fecha</th>
              <th>Distancia</th>
              <th>Tiempo</th>
              <th>Color</th>
            </tr>
          </thead>
          <tbody>
            {recorridos.map((data, index) => {
              const formattedDate = convertirFormatoFecha(data);

              return (
                <tr key={index}>
                  <td>{formattedDate}</td>
                  <td>{data.distanciaKilometros.toFixed(3)} km</td>
                  <td>{data.tiempoHoras.toFixed(3)} hrs</td>
                  <td style={{ background: data.color }}>
                    <div></div>
                  </td>
                </tr>
              );
            })}
          </tbody>
        </table>
      </div>
      <div className="view-total-distance">
        <MapContainer
          center={[0, 0]}
          zoom={28}
          scrollWheelZoom={true}
          className="map-view-total-distance"
          zoomControl={true}
        >
          <TileLayer
            url="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"
            attribution='&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
          />
          <Marker position={posicionActual} />

          <GeoJSON data={polilineas} style={{color:"red"}}/>

          <RecenterAutomatically
            lat={posicionActual[0]}
            lng={posicionActual[1]}
          />
        </MapContainer>
      </div>
    </div>
  );
};

export default VerRecorridosMapa;
